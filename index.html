<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>WebSocket Test</title>
    </head>
	<body>
        <button id="connect">Connect</button>
        <button id="disconnect">Disconnect</button>
        <p id="received">
            <strong>Received Messages:</strong>
        </p>
        <input id="message-box" type="text" name="message">
        <button id="submit">Submit</button>
    </body>
    
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script>
        let socket = undefined;

        function connect() {
            if (socket) { 
                write_to_log("Already connected to server!");
                return;
            }

            write_to_log("Connecting to server...");
            socket = new WebSocket("ws://127.0.0.1:2794", "thirteen-game");
            socket.onmessage = event => write_to_log(event.data);
        }

        function disconnect() {
            if (!socket) {
                write_to_log("You're not connected to the server!");
                return;
            }

            write_to_log("Disconnecting from server.");
            socket.close();
            socket = undefined;
        }

        function write_to_log(msg) {
            let received = document.getElementById("received");
            let br = document.createElement("br");
            let text = document.createTextNode(msg);
            received.append(br, text);
        }

        $("#connect").click(connect);

        $("#disconnect").click(disconnect);
        
        $("#submit").click(() => {
            if (!socket) {
                write_to_log("You can't send anything, you're not connected!");
                return;
            }
            let input = $("#message-box").val()
            socket.send(input);
        })
    </script>
</html>